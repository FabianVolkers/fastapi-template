# windbox-config-service

Config service as RESTful API for the WindBox project. Built with FastAPI

## Running the development environment with make

All of the steps identified below can also be run using make and the `Makefile`.

### Bootstrap development environment

```zsh
# Configure venv, install pip requirements and setup db
make bootstrap
# Run the development server
make run
```

### Development tools usage

```zsh
# Linting 
make lint
# Formatting
make format
# Testing
make test
```

### Setup virtual environment

Setup a virtual environment using your preferred tool.

```zsh
# Install requirements
pip install -r requirements.txt
pip install -e .

```

### Create the development database

We use alembic for db migrations.

```zsh
cd app
alembic upgrade head
```


### Run the app

```zsh
# cd $PROJECT_ROOT
# Start development server
uvicorn main:app --reload
```

The API will be accessible at http://127.0.0.1:8000, with the autogenerated docs available at http://127.0.0.1:8000/docs.

### Development tools

For this project, we employ the following tools to streamline development.

#### flake8

A python linter enforcing the pep8 style guide

Usage:

```zsh
flake8 /path/to/file/or/directory
```

#### autopep8

 A python code formatting tool

Usage:

```zsh
autopep8 --in-place --aggressive /path/to/file
```
 
#### Python refactor

 A vscode extension for refactoring python code

Usage:

- Sorting imports: `shift` + `command` + `p`: python refactor: sort imports

## Running the development environment with make poetry

### Install Poetry

```zsh
ln -s /etc/ssl/* /Library/Frameworks/Python.framework/Versions/3.8/etc/openssl 
curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/install-poetry.py | python3 -
```

### Install dependencies

```zsh
poetry install
```

### Run the development server

```zsh
poetry run serve
```

### Setup or migrate db

```zsh
poetry run setup_db
```

### Run tests

```zsh
poetry run pytest
```
